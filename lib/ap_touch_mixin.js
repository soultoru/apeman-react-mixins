/**
 * Mixin to add touch handlers.
 * @constructor ApTouchMixin
 */

"use strict";

var _react = require("react");

var _react2 = _interopRequireDefault(_react);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var TOUCH_HAMMER_KEY = "_apTouchHammer";

function createTouchHammer(node, props) {
    var Hammer = require('hammerjs'),
        hammer = new Hammer(node);
    if (props.touchOptions) {
        hammer.set(props.touchOptions);
    }
    Object.keys(ApTouchMixin.propTypes).filter(function (key) {
        return !!props[key];
    }).forEach(function (key) {
        if (/^on/.test(key)) {
            var event = key.replace(/^on/, '').toLowerCase();
            hammer.on(event, props[key]);
        }
        if (/Direction$/.test(key)) {
            var gesture = key.replace(/Direction$/, '');
            hammer.get(gesture).set({ direction: Hammer['DIRECTION_' + props[key]] });
        }
        if (/Threshold$/.test(key)) {
            var threshold = key.replace(/Threshold$/, '');
            hammer.get(threshold).set({ threshold: props[key] });
        }
    });
    return hammer;
}

function destroyTouchHammer(hammer) {
    if (!hammer) {
        return;
    }
    hammer.stop();
    hammer.destroy();
}

function supportsTouch(props) {
    var touchableKey = Object.keys(ApTouchMixin.propTypes);
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
        for (var _iterator = Object.keys(props)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            var key = _step.value;

            var hit = !! ~touchableKey.indexOf(key);
            if (hit) {
                return true;
            }
        }
    } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
    } finally {
        try {
            if (!_iteratorNormalCompletion && _iterator.return) {
                _iterator.return();
            }
        } finally {
            if (_didIteratorError) {
                throw _iteratorError;
            }
        }
    }

    return false;
}

/** Enum for touching */
var touchEnums = {
    directions: ['NONE', 'LEFT', 'RIGHT', 'UP', 'DOWN', 'HORIZONTAL', 'VERTICAL', 'ALL']
};

/** @lends ApTouchMixin */
var ApTouchMixin = {

    //--------------------
    // Custom
    //--------------------

    //--------------------
    // Specs
    //--------------------

    propTypes: {
        onTap: _react.PropTypes.func,
        onDoubleTap: _react.PropTypes.func,
        onPan: _react.PropTypes.func,
        onPanStart: _react.PropTypes.func,
        onPanMove: _react.PropTypes.func,
        onPanEnd: _react.PropTypes.func,
        onPanCancel: _react.PropTypes.func,
        onSwipe: _react.PropTypes.func,
        onPress: _react.PropTypes.func,
        onPressUp: _react.PropTypes.func,
        onPinch: _react.PropTypes.func,
        onPinchStart: _react.PropTypes.func,
        onPinchMove: _react.PropTypes.func,
        onPinchEnd: _react.PropTypes.func,
        onPinchCancel: _react.PropTypes.func,
        onRotate: _react.PropTypes.func,
        onRotateStart: _react.PropTypes.func,
        onRotateMove: _react.PropTypes.func,
        onRotateEnd: _react.PropTypes.func,
        onRotateCancel: _react.PropTypes.func,
        touchOptions: _react.PropTypes.object,
        panThreshold: _react.PropTypes.number,
        panDirection: _react.PropTypes.oneOf(touchEnums.directions),
        swipeDirection: _react.PropTypes.oneOf(touchEnums.directions)
    },

    statics: {},

    //--------------------
    // Lifecycle
    //--------------------

    componentWillMount: function componentWillMount() {},
    componentDidMount: function componentDidMount() {
        var s = this;
        var touchable = supportsTouch(s.props);
        if (touchable) {
            s[TOUCH_HAMMER_KEY] = createTouchHammer(ReactDOM.findDOMNode(s), s.props);
        }
    },
    componentWillReceiveProps: function componentWillReceiveProps(nextProps) {
        var s = this;
    },
    componentWillUpdate: function componentWillUpdate(nextProps, nextState) {
        var s = this;
    },
    componentDidUpdate: function componentDidUpdate(prevProps, prevState) {
        var s = this;
    },
    componentWillUnmount: function componentWillUnmount() {
        var s = this;
        var hammer = s[TOUCH_HAMMER_KEY];
        if (hammer) {
            destroyTouchHammer(hammer);
        }
        delete s[TOUCH_HAMMER_KEY];
    }
};

module.exports = Object.freeze(ApTouchMixin);
//# sourceMappingURL=data:application/json;base64,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QUFZLENBQUMsQ0FBQyIsImZpbGUiOiJhcF90b3VjaF9taXhpbi5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvb2t1bmlzaGluaXNoaS9wcm9qZWN0cy9hcGVtYW4tcmVhY3QtbWl4aW5zL2xpYiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTWl4aW4gdG8gYWRkIHRvdWNoIGhhbmRsZXJzLlxuICogQGNvbnN0cnVjdG9yIEFwVG91Y2hNaXhpblxuICovXG5cblwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUmVhY3QsIHtQcm9wVHlwZXMgYXMgdHlwZXN9IGZyb20gJ3JlYWN0JztcblxuY29uc3QgVE9VQ0hfSEFNTUVSX0tFWSA9IFwiX2FwVG91Y2hIYW1tZXJcIjtcblxuZnVuY3Rpb24gY3JlYXRlVG91Y2hIYW1tZXIobm9kZSwgcHJvcHMpIHtcbiAgICBsZXQgSGFtbWVyID0gcmVxdWlyZSgnaGFtbWVyanMnKSxcbiAgICAgICAgaGFtbWVyID0gbmV3IEhhbW1lcihub2RlKTtcbiAgICBpZiAocHJvcHMudG91Y2hPcHRpb25zKSB7XG4gICAgICAgIGhhbW1lci5zZXQocHJvcHMudG91Y2hPcHRpb25zKTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMoQXBUb3VjaE1peGluLnByb3BUeXBlcylcbiAgICAgICAgLmZpbHRlcihrZXkgPT4gISFwcm9wc1trZXldKVxuICAgICAgICAuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgaWYgKC9eb24vLnRlc3Qoa2V5KSkge1xuICAgICAgICAgICAgICAgIGxldCBldmVudCA9IGtleS5yZXBsYWNlKC9eb24vLCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBoYW1tZXIub24oZXZlbnQsIHByb3BzW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKC9EaXJlY3Rpb24kLy50ZXN0KGtleSkpIHtcbiAgICAgICAgICAgICAgICBsZXQgZ2VzdHVyZSA9IGtleS5yZXBsYWNlKC9EaXJlY3Rpb24kLywgJycpO1xuICAgICAgICAgICAgICAgIGhhbW1lci5nZXQoZ2VzdHVyZSkuc2V0KHtkaXJlY3Rpb246IEhhbW1lclsnRElSRUNUSU9OXycgKyBwcm9wc1trZXldXX0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoL1RocmVzaG9sZCQvLnRlc3Qoa2V5KSkge1xuICAgICAgICAgICAgICAgIGxldCB0aHJlc2hvbGQgPSBrZXkucmVwbGFjZSgvVGhyZXNob2xkJC8sICcnKTtcbiAgICAgICAgICAgICAgICBoYW1tZXIuZ2V0KHRocmVzaG9sZCkuc2V0KHt0aHJlc2hvbGQ6IHByb3BzW2tleV19KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIGhhbW1lcjtcbn1cblxuZnVuY3Rpb24gZGVzdHJveVRvdWNoSGFtbWVyKGhhbW1lcikge1xuICAgIGlmICghaGFtbWVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaGFtbWVyLnN0b3AoKTtcbiAgICBoYW1tZXIuZGVzdHJveSgpO1xufVxuXG5mdW5jdGlvbiBzdXBwb3J0c1RvdWNoKHByb3BzKSB7XG4gICAgbGV0IHRvdWNoYWJsZUtleSA9IE9iamVjdC5rZXlzKEFwVG91Y2hNaXhpbi5wcm9wVHlwZXMpO1xuICAgIGZvciAobGV0IGtleSBvZiBPYmplY3Qua2V5cyhwcm9wcykpIHtcbiAgICAgICAgbGV0IGhpdCA9ICEhfnRvdWNoYWJsZUtleS5pbmRleE9mKGtleSk7XG4gICAgICAgIGlmIChoaXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLyoqIEVudW0gZm9yIHRvdWNoaW5nICovXG5jb25zdCB0b3VjaEVudW1zID0ge1xuICAgIGRpcmVjdGlvbnM6IFtcbiAgICAgICAgJ05PTkUnLFxuICAgICAgICAnTEVGVCcsXG4gICAgICAgICdSSUdIVCcsXG4gICAgICAgICdVUCcsXG4gICAgICAgICdET1dOJyxcbiAgICAgICAgJ0hPUklaT05UQUwnLFxuICAgICAgICAnVkVSVElDQUwnLFxuICAgICAgICAnQUxMJ1xuICAgIF1cbn07XG5cbi8qKiBAbGVuZHMgQXBUb3VjaE1peGluICovXG5sZXQgQXBUb3VjaE1peGluID0ge1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEN1c3RvbVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNwZWNzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgcHJvcFR5cGVzOiB7XG4gICAgICAgIG9uVGFwOiB0eXBlcy5mdW5jLFxuICAgICAgICBvbkRvdWJsZVRhcDogdHlwZXMuZnVuYyxcbiAgICAgICAgb25QYW46IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGFuU3RhcnQ6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGFuTW92ZTogdHlwZXMuZnVuYyxcbiAgICAgICAgb25QYW5FbmQ6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGFuQ2FuY2VsOiB0eXBlcy5mdW5jLFxuICAgICAgICBvblN3aXBlOiB0eXBlcy5mdW5jLFxuICAgICAgICBvblByZXNzOiB0eXBlcy5mdW5jLFxuICAgICAgICBvblByZXNzVXA6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGluY2g6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGluY2hTdGFydDogdHlwZXMuZnVuYyxcbiAgICAgICAgb25QaW5jaE1vdmU6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGluY2hFbmQ6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUGluY2hDYW5jZWw6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUm90YXRlOiB0eXBlcy5mdW5jLFxuICAgICAgICBvblJvdGF0ZVN0YXJ0OiB0eXBlcy5mdW5jLFxuICAgICAgICBvblJvdGF0ZU1vdmU6IHR5cGVzLmZ1bmMsXG4gICAgICAgIG9uUm90YXRlRW5kOiB0eXBlcy5mdW5jLFxuICAgICAgICBvblJvdGF0ZUNhbmNlbDogdHlwZXMuZnVuYyxcbiAgICAgICAgdG91Y2hPcHRpb25zOiB0eXBlcy5vYmplY3QsXG4gICAgICAgIHBhblRocmVzaG9sZDogdHlwZXMubnVtYmVyLFxuICAgICAgICBwYW5EaXJlY3Rpb246IHR5cGVzLm9uZU9mKHRvdWNoRW51bXMuZGlyZWN0aW9ucyksXG4gICAgICAgIHN3aXBlRGlyZWN0aW9uOiB0eXBlcy5vbmVPZih0b3VjaEVudW1zLmRpcmVjdGlvbnMpXG4gICAgfSxcblxuICAgIHN0YXRpY3M6IHt9LFxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICAgICAgbGV0IHRvdWNoYWJsZSA9IHN1cHBvcnRzVG91Y2gocy5wcm9wcyk7XG4gICAgICAgIGlmICh0b3VjaGFibGUpIHtcbiAgICAgICAgICAgIHNbVE9VQ0hfSEFNTUVSX0tFWV0gPSBjcmVhdGVUb3VjaEhhbW1lcihSZWFjdERPTS5maW5kRE9NTm9kZShzKSwgcy5wcm9wcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzO1xuICAgIH0sXG5cbiAgICBjb21wb25lbnRXaWxsVXBkYXRlKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICB9LFxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICAgICAgbGV0IGhhbW1lciA9IHNbVE9VQ0hfSEFNTUVSX0tFWV07XG4gICAgICAgIGlmIChoYW1tZXIpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lUb3VjaEhhbW1lcihoYW1tZXIpO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBzW1RPVUNIX0hBTU1FUl9LRVldO1xuICAgIH1cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZnJlZXplKEFwVG91Y2hNaXhpbik7XG4iXX0=